---
title : "rgbCTF Crypto writeup 보고 공부"
excerpt : "rgbCTF Crypto Writeup 보고 공부"
toc : true
toc_sticky : true
categories :
  - Crypto
tags :
  - rgbCTF 
---

## Beginner - A Fine Day
```
It's a fine day to break some ciphers!

Sujd jd bgxopksbm ljsu tg tqqjgb xjkubo. Tqqjgb xjkubod tob t qvor vq dhidsjshsjvg xjkubo. Jsd nbp xvgdjdsd vq slv ghribod, t tgm i. Sv bgxopks t cbssbo, rhcsjkcp jsd kctxb jg sub tckutibs (dv t=0, i=1, bsx.) ip t, tgm subg tmm i. Qjgtccp stnb suts rvm 26 tgm xvgwbos js itxn jgsv t xutotxsbo.
Sub tqqjgb xjkubo jdg's obtccp suts dsovgf. Djgxb js'd rvm 26, subob tob vgcp t qbl uhgmobm mjqqbobgs nbpd, lujxu xtg ib btdjcp iohsb qvoxbm. Tgpltp, ubob'd pvho qctf: ofiXSQ{t_qjgb_tqqjgb_xjkubo}

~qpwoeirut#5057
```
```
Cyberchef에서 a=15, b=19로 설정

This is encrypted with an affine cipher. Affine ciphers are a form of substitution cipher. Its key consists of two numbers, a and b. To encrypt a letter, multiply its place in the alphabet (so a=0, b=1, etc.) by a, and then add b. Finally take that mod 26 and convert it back into a character.
The affine cipher isn't really that strong. Since it's mod 26, there are only a few hundred different keys, which can be easily brute forced. Anyway, here's your flag: rgbCTF{a_fine_affine_cipher}
```
```
flag: rgbCTF{a_fine_affine_cipher}
```

## Beginner - Simple RSA
```
Can you find a way to attack this RSA implementation?


~qpwoeirut#5057
simple_rsa.txt Size: 0.12 KB MD5: 890e58f8d143ee2e7f761779500b591f
simple_rsa.py Size: 0.39 KB MD5: 292f34897f99b5b4178cadca1a725b80
```
```
simplersa.txt

n = 5620911691885906751399467870749963159674169260381
e = 65537
c = 1415060907955076984980255543080831671725408472748
```
공개키가 주어졌으므로 <a href="http://factordb.com/" target="_blank">tool</a>을 이용하여 ```{p, q}```를 구하여 푸는 방법으로 플래그를 얻을 수 있음.  
```python
from Crypto.Util.number import *

n= 5620911691885906751399467870749963159674169260381
p= 255097177
q= 22034393943473183756163118460342519430053
e= 65537
c= 1415060907955076984980255543080831671725408472748

phi_n = (p-1)*(q-1)

d = inverse(e,phi_n)

decrypt=pow(c,d,n)
flag=long_to_bytes(decrypt)

print(flag[::-1])
```
```
flag : rgbCTF{brut3_f0rc3}
```

## Beginner - Quirky Resolution 50 Points (풀이 봄)
```
":joy:"


~bAse#0001
quirky_resolution.png Size: 11.71 KBMD5: 8cfe1a626560c27b58f1dee59b4dfaa7
```
아래 사진, (흰색 배경이라 안보임)
![](/assets/images/rgbctf-quirky_resolution.png){: .align-center}
위 사진을 <a href="https://aperisolve.fr/" target="_blank">tool</a>을 이용하면 QR코드 사진이 나옴.  
<a href="https://zxing.org/w/decode.jspx" target="_blank">온라인 QR코드 Decoder</a>를 통해 플래그를 얻을 수 있음.
```
flag : rgbCTF{th3_qu1rk!er_th3_b3tt3r}
```

## Beginner - r/ciphers 50 Points
```
RGBsec does not endorse (or really even know at this point) what the content is on that sub reddit.
(It's just the title of the challenge)


~qpwoeirut#5057
11.txt Size: 0.52 KB MD5: 0cdd201db519b02dd0176fae954eecfb
```
```
11.txt

Nfwp wp z hkakzudfzoinwj plopnwnlnwka jwdfix, yfwjf jza oi znnzjgit ywnf mxicliajs zazuspwp. Zunfklqf nfwp znnzjg jza oi tkai os fzat, wn'p lplzuus hljf izpwix nk lpi z dxkqxzh nk tk wn mkx skl. Nyk qkkt yiopwnip nfzn ywuu tijxsdn plopnwnlnwka jwdfixp mkx skl zxi zn qlozuuz.ti/plopnwnlnwka-pkuvix zat clwdcwld.jkh. Wm skl fzvia'n nxwit nfih oimkxi, skl pfklut jfijg nfih kln. Fixi'p sklx muzq: xqoJNM{blpn_4pg_nf3_wan3xa3n_n0_t3jxsdn_wn}
Zupk, Zuij oiuwivip wn'p vixs whdkxnzan nfzn skl pii nfwp: fnndp://w.xitt.wn/1d7y8g0272851.bdq
```
단순 치환암호에 대해 복호화를 해주는 사이트가 있음. <a href="https://quipqiup.com/" target="_blank">https://quipqiup.com/</a>
```
This is a monoalphabetic substitution cipher, which can be attacked with frequency analysis. Although this attack can be done by hand, it's usually much easier to use a program to do it for you. Two good websites that will decrypt substitution ciphers for you are at guballa.de/substitution-solver and quipqiup.com. If you haven't tried them before, you should check them out. Here's your flag: rgbCTF{just_4sk_th3_int3rn3t_t0_d3crypt_it} Also, Alec believes it's very important that you see this: https://i.redd.it/1p7w8k0272851.jpg
```

## ZTC - Ralphie! 50 Points
```
Ralphie, on the double! Little Orphan Annie sent you this decoder ring, decode the secret message!

~tonyz#2403
ralphie.png Size: 38.45 KB MD5: 3197f88bcbc51c736f67722b45ddb7b6
```
![](/assets/images/rgbctf-ralphie.png){: .align-center}
```Quirky Resolution```과 똑같은 문제임.
```
flag : rgbCTF{BESURETODRINKYOUROVALTINE}
```

## Cryptography - e 144 Points (풀이 봄)
```
n = 0x5fb76f7f36c0d7788650e3e81fe18ad105970eb2dd19576d29e8a8697ebbd97f4fc2582bf1dc53d527953d9615439ca1b546b2fc1cd533db5fce6f72419f268e3182c0324a631a17d6b3e76540f52f2df51ca34983392d274f292139c28990660fa0e23d1b350da7aa7458a3783107a296dcd1720e32afb431954d8896f0587cd1c8f1d20701d6173b7cffe53679ebda80f137c83276d6628697961f5fcd39e18316770917338c6dc59a241dcdc66417fed42524c33093251c1d318b9dbeb6c3d0a69438b875958e8885d242d196e25bc73595e7f237c8124e07a79f7066f2dee393e2130306ba29e7ece1825798ff8b35416b3a0d96bcdc6eca5616ea2874954f8f88232450ddad3e109338bcc5d84e7b592a6b0871bd4130b84f81ed188e9d5495c8545aa8dea2b65e8605f5a49e3a1c221cbcc301665187658784a8f42a23c2ca2572477ba56ff19934019b48f5a1ab8a50626c85bdd476b11e8c1fb0b740c2370de3da5cc06371a7aa2c4e12eee3dc4cda07a8c84ba2bc3ee2017156468af95111d7ee5152ce35e66fa027a944b43c27fbd27faa5b4f9075be3526a7a5be8a533b523cd5c738c724e97597fc2e3666cfcad7c79d972ff8d9572100e860395cdc3761af3f4cc225a6df83a55802723f95cfba5918d83913f2cc9b219210249928c291310d449042772e2d0a50620d666a137f79770de6f10196b30cc756e1

e = 0b1101

c = 0x6003a15ff3f9bc74fcc48dc0f5fc59c31cb84df2424c9311d94cb40570eeaa78e0f8fc2917addd1afc8e5810b2e80a95019c88c4ee74849777eb9d0ee27ab80d3528c6f3f95a37d1581f9b3cd8976904c42f8613ee79cf8c94074ede9f034b61433f1fef835f2a0a45663ec4a0facedc068f6fa2b534c9c7a2f4789c699c2dcd952ed82180a6de00a51904c2df74eb73996845842276d5523c66800034351204b921d4780180ca646421c61033017e4986d9f6a892ed649c4fd40d4cf5b4faf0befb1e2098ee33b8bea461a8626dd8cd2eed05ccd471700e2a1b99ed347660cbd0f202212f6c0d7ad8ef6f878d887af0cd0429c417c9f7dd64890146b91152ea0c30637ce503635018fd2caf436a12378e5892992b8ec563f0988fc0cebd2926662d4604b8393fb2000
```
hex to decimal
```
n=390489435257757050962694900628597750000579222652331667618284165302943905225288969762176855801097841580556025206135063119377780258773946551477397214530192584542559975339905571052158012999468964332437424628306511823269722453860362280496202533043021337796709339953817006833706504476313712943965322096302491056783227523784482002015145826987110574460307401934641874704050677704711801356268639773155081360828180903299964526589331336235306332567448562160526113866018006123967625576962689761521605387494709446518692462619862696168918816662536077370130661612070397479668829129920065326461187098803231397068051063929181738677526073658243869002572485447843169095810970975008795690074220899938136361892311637145808179133421447144085978655477817360358554032010516385983131407000011685574404126645116055363989608798299433959920227740092093920293556264000720381725702113290830326487540883170568741677111457568414739635182616494007311080902460736310863610217949372424386793484900002898788953599811705062201758177232830116056373978679467452122685972908266494259227709026880378075787599801726114638151543214172984729176207988155050429283715199503476101477015502266718187756254132831832109660502543721206835505701564820158859089751904108288138208040673

e= 13

c=106043754914029053332380422656979154558759375897122425881860894698990092522305749145737374365974220063939891079764890878154070613914922418958583544498027475665662636594704078148882769433156473437121146773425968949033386468829167234570619323371997036112007508384568510674710537942785775371160931981856023034244395378977429902662365257811359886125721032794417995359223839236947456899351021253568576347533100384607077413225615309141290386668460232755119696828398399706666171431603664375206400701950963668907213087581791373592734473983283263803333104246685774546585505902951125395519774268152638482568171628156316175459200284173273491875899659385136852897094442953202427686882030389289946251863304968551409170000000000000
```
e가 너무 작다면 의심해보는 것도 좋음. n은 p,q를 확인해보려 했으나 알 수 없었음.  
근데 C는 x의 13승임을 확인해볼 수 있음. 따라서 C=x^13이라 할 때, x^13=M^13 mod(n) x= M mod (n)이므로 M=x mod(n)임.  
```python
from Crypto.Util.number import *

n= 390489435257757050962694900628597750000579222652331667618284165302943905225288969762176855801097841580556025206135063119377780258773946551477397214530192584542559975339905571052158012999468964332437424628306511823269722453860362280496202533043021337796709339953817006833706504476313712943965322096302491056783227523784482002015145826987110574460307401934641874704050677704711801356268639773155081360828180903299964526589331336235306332567448562160526113866018006123967625576962689761521605387494709446518692462619862696168918816662536077370130661612070397479668829129920065326461187098803231397068051063929181738677526073658243869002572485447843169095810970975008795690074220899938136361892311637145808179133421447144085978655477817360358554032010516385983131407000011685574404126645116055363989608798299433959920227740092093920293556264000720381725702113290830326487540883170568741677111457568414739635182616494007311080902460736310863610217949372424386793484900002898788953599811705062201758177232830116056373978679467452122685972908266494259227709026880378075787599801726114638151543214172984729176207988155050429283715199503476101477015502266718187756254132831832109660502543721206835505701564820158859089751904108288138208040673

x=11991774936877218203611546218822762533806381024952870770

plaintext=x%n
flag=long_to_bytes(plaintext).decode('utf-8')
print(flag[::-1])
```
```
flag : rgbCTF{lucky_number_13}
```
